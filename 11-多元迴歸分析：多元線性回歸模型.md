abbrlink: 34635
title: 11.多元迴歸分析：多元線性回歸模型
categories:
  - 社会统计学(张春泥)
---
多個自變量，多個（偏）斜率係數

$$
\hat{y_i}=b_0+b_1x_1+…
$$

### 1.係數估計

#### （1）測量層次

一個定量型因變量和多個自變量（定量型或處理成二分變量的定性型）

#### （2）偏效應

控制其他變量的情況下各自變量x對y的淨效應（net effect）或單獨效應（unique effect）

前提條件：其他變量在某一取值處保持不變

偏回歸係數$b_k$

#### （3）虛假相關與中介效應

#### 解釋例子

$$
\hat{earn} = 548.36 + 64.63edu + 32.12exp
$$

- ﻿截距项548.36表示当一个人没有受过正式教育井旦设有工作经历的情况下，他/她的预期年收入为548.36元。
- ﻿从教育与工作年数的回归系数发现，这两者对收入都有**正向**影响：
	- **在控制了工作年数的影响后**，个人受教育年数每增加1年，个人的年收入就平均增加64.63元。（换句话说，若两个人工作年数相同，其中一个人比另外一个人多受过一年教育，那么他/她的年收入将会高出64.63元。）
	- 同样地，在控制了教育年数以后，个人的工作经历每增加1年，个人的年收入平均增加32.12元。

### （4）假定

##### A0

##### A1正正交假定

誤差項與x不相關

##### A2獨立同分佈假定

- 獨立：每一個誤差項獨立
- 同方差性：$Var(\varepsilon _i)=\sigma^2_i=\sigma^2$

##### A3正態分佈假定

### 2.標準化回歸係數

去除測量單位比較。但寫文章最好給出未標準化的回歸方程

不同自變量間具有可比性

$$
\begin{align}
y^*_i=\frac{y_i-\bar y}{S_y}\\\\
x^*_{k_i}=\frac{x_{k_i}-\bar x_k}{S_{x_k}}
\end{align}
$$

1. 對中（centering）
2. 尺度標準化（rescaling）：變量增加多少個標準差

$$
\beta^*_k=\beta_k\frac{S_{x_k}}{S_y}
$$

### 3.統計推斷與假設檢驗

#### 假設檢驗

$$
\begin{align}
H_0&:\beta _k \\\\
H_1&:\beta _k\ne 0\\\\
Z & = \frac{b_k-0}{SE(b_k)}
\end{align}
$$
如果落在[-1.96,1.96]外，則拒絕原假設。

#### 擬合優度

整體解釋力：能解釋多少比例的納入模型的變量

回归方程的检验：建立的回归模型是否解释了总体中因变量的变异？à 对解释力指标的间接统计检验

##### 判定係數

$$
\begin{align}
SST&=SSR+SSE\\\\
能解釋的：SSR&=\sum (\hat y_i-\bar y)^2\\\\
不能解釋的：SSE&= \sum (y_i-\hat y_i)^2\\\\
R^2&=\frac{SSR}{SST} 
\end{align}
$$

F檢驗（p：該回歸方程需要估計的參數個數）：

$$
F=\frac{MSR}{MSE} =\frac{SSR/(p-1)}{SSE/(n-p)} 
$$

SSR：结构项（组间）

SSE：随机（组内）

### 4.嵌套模型

- 非限制性模型（U）：允許對所有自變量係數進行自由估計
- 限制性模型（R）：一些自變量係數限制為0或限制相等

#### 嵌套模型

$$
R\subset U
$$

如：

$$
\hat y=b_0+b_1x_1+b_2x_2+b_3x_3
$$

當滿足限制性條件：$b_1=0$，$b2=b3$時和

$$
\hat y=b_0+b_4(x_1+x_2)
$$

互為嵌套模型，前者為非限制性模型，後者為限制性模型。

#### 檢定值

加入新的自變量時，$R^2$會增加，$\Delta R^2$：判定係數增量

非限制性模型解釋力*顯著*好於限制性模型的檢驗，如果不顯著，則選擇非限制性模型為了更簡單

$$
F=\frac{(SSE_R-SSE_U)/q}{SSE_U/(n-K)}
$$

- SST保持不变；
- SSR会増加（至少不減少）；
- SSE会減少（至少不増加）；
- R<sup>2</sup>会増加（至少不減少）；
- MSR一般情况下会增加；
- MSE一般情況下会减少；
- 回歸方程F检验值一般情况下会增加。

#### 例

$$
\begin{array}{c}
&H_0:\beta _{exp}=\beta _{exp2}=0\\\\
&H_1: \beta _{exp}\ne 0或\beta _{exp2}\ne 0\\\\
&R=2310.33>F_{0.01}(q,n-K)
\end{array}
$$

在0.01水平上統計顯著，拒絕原假設，$\beta _{exp}$和$\beta _{exp2}$不同時為0

若不显著：模型2与模型1的解释力无显著差异，根据简约原则，选择模型2

#### 例

回到当堂练习-1的情景，我们分别对男性和女性样本建立回归模型，估计父母的教育年限、兄弟姐妹数对他(她)们受教育年限的影响，其中女性（女儿）样本的模型估计如下：

$$
\hat{cedu}=9.90+0.27fedu+0.23medu-0.87sib
$$

问：如果我们想知道父亲和母亲对女儿教育成就的效应（非标准化回归系数）在总体中是不是一样的？请你利用今天所学的知识给出解决方案。


### 拓展：因變量方差削減的方法

中國和美國收入的不同因素影響中佔主要的

